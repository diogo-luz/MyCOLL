@using MyCOLL.Shared.DTOs

<div class="category-slider">
    <button class="slider-arrow left" @onclick="ScrollLeft">â€¹</button>
    
    <div class="categories-container" @ref="_container">
        @foreach (var categoria in Categorias) {
            <div class="category-card @(SelectedId == categoria.Id ? "selected" : "")"
                 @onclick="() => SelectCategory(categoria.Id)">
                @if (categoria.Imagem != null) {
                    <img src="data:image/png;base64,@Convert.ToBase64String(categoria.Imagem)" 
                         alt="@categoria.Nome" class="category-image" />
                } else {
                    <div class="category-placeholder">ðŸ“¦</div>
                }
                <span class="category-name">@categoria.Nome</span>
            </div>
        }
    </div>
    
    <button class="slider-arrow right" @onclick="ScrollRight">â€º</button>
</div>

@code {
    [Parameter] public List<CategoriaDTO> Categorias { get; set; } = new();
    [Parameter] public int? SelectedId { get; set; }
    [Parameter] public EventCallback<int?> OnCategorySelected { get; set; }

    private ElementReference _container;

    private async Task SelectCategory(int id) {
        if (SelectedId == id) {
            SelectedId = null; // Deselect if clicking same
        } else {
            SelectedId = id;
        }
        await OnCategorySelected.InvokeAsync(SelectedId);
    }

    private async Task ScrollLeft() {
        // JS Interop would be needed for actual scrolling
    }

    private async Task ScrollRight() {
        // JS Interop would be needed for actual scrolling
    }
}
